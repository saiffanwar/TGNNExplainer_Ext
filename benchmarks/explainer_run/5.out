PYTHONPATH=/dcs/pg21/u2188448/TGNNExplainer_Ext/tgnnexplainer
#Dataset: wikipedia, #Users: 8227, #Items: 1000, #Interactions: 157474, #Timestamps: 152757
#node feats shape: (9228, 172), #edge feats shape: (157475, 172)
443 events to explain
[2025-01-25 02:47:37,552][src.models.ext.tgat.module][INFO] - Aggregation uses attention model
[2025-01-25 02:47:37,564][src.models.ext.tgat.module][INFO] - Using scaled prod attention
[2025-01-25 02:47:37,574][src.models.ext.tgat.module][INFO] - Using scaled prod attention
[2025-01-25 02:47:37,574][src.models.ext.tgat.module][INFO] - Using time encoding
USING EXPLAINER: tgnnexplainer
USING MODEL: tgat
Initializing TGNNExplainer
150 180
Running results batch 5 with 30 events

explain 0-th: 34381 on batch 5
119
Exp Len:  10 Model Pred:  3.3537955284118652 Exp Pred:  3.637423515319824 Unimportant Pred 3.1332621574401855 Delta Fidelity:  -0.0630946159362793
Exp Len:  20 Model Pred:  3.3537955284118652 Exp Pred:  3.6487765312194824 Unimportant Pred 2.689389228820801 Delta Fidelity:  0.36942529678344727
Exp Len:  40 Model Pred:  3.3537955284118652 Exp Pred:  3.3488473892211914 Unimportant Pred 2.7913568019866943 Delta Fidelity:  0.5574905872344971
Exp Len:  80 Model Pred:  3.3537955284118652 Exp Pred:  3.467332363128662 Unimportant Pred 0.6581085920333862 Delta Fidelity:  2.582150101661682

explain 1-th: 34509 on batch 5
275
Exp Len:  10 Model Pred:  3.996145248413086 Exp Pred:  2.6797571182250977 Unimportant Pred 3.238919734954834 Delta Fidelity:  -0.5591626167297363
Exp Len:  20 Model Pred:  3.996145248413086 Exp Pred:  5.161251068115234 Unimportant Pred 2.317899703979492 Delta Fidelity:  0.5131397247314453
Exp Len:  40 Model Pred:  3.996145248413086 Exp Pred:  3.9933691024780273 Unimportant Pred 2.4405579566955566 Delta Fidelity:  1.5528111457824707
Exp Len:  80 Model Pred:  3.996145248413086 Exp Pred:  4.16459846496582 Unimportant Pred 1.122734546661377 Delta Fidelity:  2.7049574851989746

explain 2-th: 34656 on batch 5
183
Exp Len:  10 Model Pred:  0.7179418802261353 Exp Pred:  0.6258031129837036 Unimportant Pred 0.7705230712890625 Delta Fidelity:  -0.039557576179504395
Exp Len:  20 Model Pred:  0.7179418802261353 Exp Pred:  0.6490179300308228 Unimportant Pred 0.841888427734375 Delta Fidelity:  0.055022597312927246
Exp Len:  40 Model Pred:  0.7179418802261353 Exp Pred:  0.7218258380889893 Unimportant Pred 0.7788941860198975 Delta Fidelity:  0.0570683479309082
Exp Len:  80 Model Pred:  0.7179418802261353 Exp Pred:  0.7216449975967407 Unimportant Pred 0.3471857011318207 Delta Fidelity:  0.3670530617237091

explain 3-th: 34692 on batch 5
104
Exp Len:  10 Model Pred:  1.8637938499450684 Exp Pred:  3.5837221145629883 Unimportant Pred 0.5117200613021851 Delta Fidelity:  -0.3678544759750366
Exp Len:  20 Model Pred:  1.8637938499450684 Exp Pred:  3.111114740371704 Unimportant Pred 0.5510220527648926 Delta Fidelity:  0.06545090675354004
Exp Len:  40 Model Pred:  1.8637938499450684 Exp Pred:  2.733292579650879 Unimportant Pred 0.6709527969360352 Delta Fidelity:  0.32334232330322266
Exp Len:  80 Model Pred:  1.8637938499450684 Exp Pred:  2.056276559829712 Unimportant Pred 0.7836185693740845 Delta Fidelity:  0.8876925706863403

explain 4-th: 34868 on batch 5
389
Exp Len:  10 Model Pred:  -0.11002108454704285 Exp Pred:  -0.29916301369667053 Unimportant Pred -0.10518145561218262 Delta Fidelity:  -0.18430230021476746
Exp Len:  20 Model Pred:  -0.11002108454704285 Exp Pred:  -0.18027013540267944 Unimportant Pred -0.09214797616004944 Delta Fidelity:  -0.05237594246864319
Exp Len:  40 Model Pred:  -0.11002108454704285 Exp Pred:  -0.2071835994720459 Unimportant Pred -0.05407440662384033 Delta Fidelity:  -0.04121583700180054
Exp Len:  80 Model Pred:  -0.11002108454704285 Exp Pred:  -0.1855337917804718 Unimportant Pred -0.0058934688568115234 Delta Fidelity:  0.028614908456802368

explain 5-th: 35021 on batch 5
158
Exp Len:  10 Model Pred:  2.690809488296509 Exp Pred:  4.38423490524292 Unimportant Pred -0.0756603479385376 Delta Fidelity:  1.0730444192886353
Exp Len:  20 Model Pred:  2.690809488296509 Exp Pred:  3.646328926086426 Unimportant Pred 2.583643674850464 Delta Fidelity:  -0.8483536243438721
Exp Len:  40 Model Pred:  2.690809488296509 Exp Pred:  3.0050904750823975 Unimportant Pred 2.9573493003845215 Delta Fidelity:  -0.04774117469787598
Exp Len:  80 Model Pred:  2.690809488296509 Exp Pred:  3.133777141571045 Unimportant Pred 0.859474778175354 Delta Fidelity:  1.3883670568466187

explain 6-th: 35054 on batch 5
295
Exp Len:  10 Model Pred:  3.8822431564331055 Exp Pred:  5.07698392868042 Unimportant Pred 3.024111747741699 Delta Fidelity:  -0.3366093635559082
Exp Len:  20 Model Pred:  3.8822431564331055 Exp Pred:  4.757439136505127 Unimportant Pred 3.117182970046997 Delta Fidelity:  -0.11013579368591309
Exp Len:  40 Model Pred:  3.8822431564331055 Exp Pred:  4.082620143890381 Unimportant Pred 3.079180955886841 Delta Fidelity:  0.6026852130889893
Exp Len:  80 Model Pred:  3.8822431564331055 Exp Pred:  4.006266117095947 Unimportant Pred -1.102481722831726 Delta Fidelity:  4.86070191860199

explain 7-th: 35248 on batch 5
400
Exp Len:  10 Model Pred:  -1.097193717956543 Exp Pred:  0.2226930856704712 Unimportant Pred -1.2233778238296509 Delta Fidelity:  -1.1937026977539062
Exp Len:  20 Model Pred:  -1.097193717956543 Exp Pred:  0.3461786210536957 Unimportant Pred -0.7012495994567871 Delta Fidelity:  -1.0474282205104828
Exp Len:  40 Model Pred:  -1.097193717956543 Exp Pred:  -0.3651840388774872 Unimportant Pred -0.39887097477912903 Delta Fidelity:  -0.033686935901641846
Exp Len:  80 Model Pred:  -1.097193717956543 Exp Pred:  -1.3105112314224243 Unimportant Pred 0.34509119391441345 Delta Fidelity:  1.228967398405075

explain 8-th: 35310 on batch 5
241
Exp Len:  10 Model Pred:  0.867621898651123 Exp Pred:  0.868788480758667 Unimportant Pred 0.6821146011352539 Delta Fidelity:  0.1843407154083252
Exp Len:  20 Model Pred:  0.867621898651123 Exp Pred:  0.9670289754867554 Unimportant Pred 0.37260472774505615 Delta Fidelity:  0.39561009407043457
Exp Len:  40 Model Pred:  0.867621898651123 Exp Pred:  0.6383446455001831 Unimportant Pred 0.5209259986877441 Delta Fidelity:  0.11741864681243896
Exp Len:  80 Model Pred:  0.867621898651123 Exp Pred:  0.5192966461181641 Unimportant Pred 0.9466303586959839 Delta Fidelity:  -0.26931679248809814

explain 9-th: 35347 on batch 5
269
Exp Len:  10 Model Pred:  4.935855865478516 Exp Pred:  5.271797180175781 Unimportant Pred 0.939098596572876 Delta Fidelity:  3.660815954208374
Exp Len:  20 Model Pred:  4.935855865478516 Exp Pred:  5.127432823181152 Unimportant Pred 4.019641876220703 Delta Fidelity:  0.7246370315551758
Exp Len:  40 Model Pred:  4.935855865478516 Exp Pred:  4.938836097717285 Unimportant Pred 1.3193919658660889 Delta Fidelity:  3.6134836673736572
Exp Len:  80 Model Pred:  4.935855865478516 Exp Pred:  4.935644149780273 Unimportant Pred 0.8924949169158936 Delta Fidelity:  4.04314923286438

explain 10-th: 35348 on batch 5
95
Exp Len:  10 Model Pred:  4.335359573364258 Exp Pred:  4.980310916900635 Unimportant Pred 3.962404251098633 Delta Fidelity:  -0.27199602127075195
Exp Len:  20 Model Pred:  4.335359573364258 Exp Pred:  4.72297477722168 Unimportant Pred 4.142302513122559 Delta Fidelity:  -0.19455814361572266
Exp Len:  40 Model Pred:  4.335359573364258 Exp Pred:  4.305137634277344 Unimportant Pred 4.685787200927734 Delta Fidelity:  0.3202056884765625
Exp Len:  80 Model Pred:  4.335359573364258 Exp Pred:  4.394350051879883 Unimportant Pred 0.556907057762146 Delta Fidelity:  3.719462037086487

explain 11-th: 35535 on batch 5
400
Exp Len:  10 Model Pred:  2.3342719078063965 Exp Pred:  0.8534080982208252 Unimportant Pred 2.4418578147888184 Delta Fidelity:  -1.3732779026031494
Exp Len:  20 Model Pred:  2.3342719078063965 Exp Pred:  1.0325813293457031 Unimportant Pred 2.4412620067596436 Delta Fidelity:  -1.1947004795074463
Exp Len:  40 Model Pred:  2.3342719078063965 Exp Pred:  3.9284496307373047 Unimportant Pred 0.30190280079841614 Delta Fidelity:  0.43819138407707214
Exp Len:  80 Model Pred:  2.3342719078063965 Exp Pred:  3.233689546585083 Unimportant Pred -0.3745137155056 Delta Fidelity:  1.80936798453331

explain 12-th: 35694 on batch 5
143
Exp Len:  10 Model Pred:  4.997264385223389 Exp Pred:  5.437027454376221 Unimportant Pred 4.0127458572387695 Delta Fidelity:  0.5447554588317871
Exp Len:  20 Model Pred:  4.997264385223389 Exp Pred:  5.384892463684082 Unimportant Pred 4.079591751098633 Delta Fidelity:  0.5300445556640625
Exp Len:  40 Model Pred:  4.997264385223389 Exp Pred:  5.081352233886719 Unimportant Pred 4.42487907409668 Delta Fidelity:  0.4882974624633789
Exp Len:  80 Model Pred:  4.997264385223389 Exp Pred:  5.253763198852539 Unimportant Pred 0.6925368309020996 Delta Fidelity:  4.048228740692139

explain 13-th: 35820 on batch 5
321
Exp Len:  10 Model Pred:  5.931844711303711 Exp Pred:  5.903809547424316 Unimportant Pred 0.517167329788208 Delta Fidelity:  5.386642217636108
Exp Len:  20 Model Pred:  5.931844711303711 Exp Pred:  5.974575042724609 Unimportant Pred 0.5082687139511108 Delta Fidelity:  5.380845665931702
Exp Len:  40 Model Pred:  5.931844711303711 Exp Pred:  5.93026065826416 Unimportant Pred -0.000957489013671875 Delta Fidelity:  5.931218147277832
Exp Len:  80 Model Pred:  5.931844711303711 Exp Pred:  5.940293312072754 Unimportant Pred 0.15626227855682373 Delta Fidelity:  5.767133831977844

explain 14-th: 36213 on batch 5
60
Exp Len:  10 Model Pred:  4.625391006469727 Exp Pred:  5.298279762268066 Unimportant Pred 4.303171634674072 Delta Fidelity:  -0.35066938400268555
Exp Len:  20 Model Pred:  4.625391006469727 Exp Pred:  5.2072954177856445 Unimportant Pred 3.7680656909942627 Delta Fidelity:  0.2754209041595459
Exp Len:  40 Model Pred:  4.625391006469727 Exp Pred:  4.818799018859863 Unimportant Pred 3.3314547538757324 Delta Fidelity:  1.1005282402038574
Exp Len:  59 Model Pred:  4.625391006469727 Exp Pred:  4.62565279006958 Unimportant Pred 0.3232683837413788 Delta Fidelity:  4.301860839128494

explain 15-th: 36233 on batch 5
62
Exp Len:  10 Model Pred:  3.686821460723877 Exp Pred:  4.369139671325684 Unimportant Pred 3.0437393188476562 Delta Fidelity:  -0.03923606872558594
Exp Len:  20 Model Pred:  3.686821460723877 Exp Pred:  4.026165962219238 Unimportant Pred 3.4315428733825684 Delta Fidelity:  -0.08406591415405273
Exp Len:  40 Model Pred:  3.686821460723877 Exp Pred:  3.975931167602539 Unimportant Pred 0.6510992050170898 Delta Fidelity:  2.746612548828125
Exp Len:  61 Model Pred:  3.686821460723877 Exp Pred:  3.6874184608459473 Unimportant Pred 0.16460376977920532 Delta Fidelity:  3.5216206908226013

explain 16-th: 36280 on batch 5
25
Exp Len:  10 Model Pred:  4.1128249168396 Exp Pred:  4.012526512145996 Unimportant Pred 2.8835530281066895 Delta Fidelity:  1.1289734840393066
Exp Len:  20 Model Pred:  4.1128249168396 Exp Pred:  4.220711708068848 Unimportant Pred 0.07359671592712402 Delta Fidelity:  3.9313414096832275
Exp Len:  24 Model Pred:  4.1128249168396 Exp Pred:  4.112945079803467 Unimportant Pred -1.2697911262512207 Delta Fidelity:  5.382495880126953
Exp Len:  24 Model Pred:  4.1128249168396 Exp Pred:  4.112945079803467 Unimportant Pred -1.2697911262512207 Delta Fidelity:  5.382495880126953

explain 17-th: 36322 on batch 5
400
Exp Len:  10 Model Pred:  -0.10552854835987091 Exp Pred:  0.7775106430053711 Unimportant Pred 0.11271411180496216 Delta Fidelity:  -0.6647965312004089
Exp Len:  20 Model Pred:  -0.10552854835987091 Exp Pred:  -0.24748514592647552 Unimportant Pred 0.21385961771011353 Delta Fidelity:  0.17743156850337982
Exp Len:  40 Model Pred:  -0.10552854835987091 Exp Pred:  -0.5195263624191284 Unimportant Pred -0.29135167598724365 Delta Fidelity:  -0.22817468643188477
Exp Len:  80 Model Pred:  -0.10552854835987091 Exp Pred:  -0.38799428939819336 Unimportant Pred -1.0997637510299683 Delta Fidelity:  0.7117694616317749

explain 18-th: 36587 on batch 5
55
Exp Len:  10 Model Pred:  -0.3866671621799469 Exp Pred:  -0.3768114447593689 Unimportant Pred -0.36993905901908875 Delta Fidelity:  0.006872385740280151
Exp Len:  20 Model Pred:  -0.3866671621799469 Exp Pred:  -0.3881967067718506 Unimportant Pred -0.27559468150138855 Delta Fidelity:  0.10954293608665466
Exp Len:  40 Model Pred:  -0.3866671621799469 Exp Pred:  -0.39272958040237427 Unimportant Pred -0.08714704215526581 Delta Fidelity:  0.2934577018022537
Exp Len:  54 Model Pred:  -0.3866671621799469 Exp Pred:  -0.3867887556552887 Unimportant Pred 0.1543116569519043 Delta Fidelity:  0.5408572256565094

explain 19-th: 36663 on batch 5
219
Exp Len:  10 Model Pred:  0.30981966853141785 Exp Pred:  0.6918659210205078 Unimportant Pred 0.4887448847293854 Delta Fidelity:  -0.20312103629112244
Exp Len:  20 Model Pred:  0.30981966853141785 Exp Pred:  0.3712652027606964 Unimportant Pred 0.7102649211883545 Delta Fidelity:  0.3389997184276581
Exp Len:  40 Model Pred:  0.30981966853141785 Exp Pred:  0.3054797351360321 Unimportant Pred 0.7590301036834717 Delta Fidelity:  0.4448705017566681
Exp Len:  80 Model Pred:  0.30981966853141785 Exp Pred:  0.33831802010536194 Unimportant Pred 0.7728884220123291 Delta Fidelity:  0.43457040190696716

explain 20-th: 36695 on batch 5
400
Exp Len:  10 Model Pred:  3.142899990081787 Exp Pred:  -0.7590891122817993 Unimportant Pred 2.313965320587158 Delta Fidelity:  -3.0730544328689575
Exp Len:  20 Model Pred:  3.142899990081787 Exp Pred:  0.03740319609642029 Unimportant Pred 2.374880313873291 Delta Fidelity:  -2.3374771177768707
Exp Len:  40 Model Pred:  3.142899990081787 Exp Pred:  2.352813243865967 Unimportant Pred 0.9741718769073486 Delta Fidelity:  1.3786413669586182
Exp Len:  80 Model Pred:  3.142899990081787 Exp Pred:  2.2577953338623047 Unimportant Pred 1.1381936073303223 Delta Fidelity:  1.1196017265319824

explain 21-th: 36716 on batch 5
211
Exp Len:  10 Model Pred:  0.7254630327224731 Exp Pred:  -1.4879014492034912 Unimportant Pred 0.5023380517959595 Delta Fidelity:  -1.9902395009994507
Exp Len:  20 Model Pred:  0.7254630327224731 Exp Pred:  -1.4879014492034912 Unimportant Pred 0.6018029451370239 Delta Fidelity:  -2.089704394340515
Exp Len:  40 Model Pred:  0.7254630327224731 Exp Pred:  0.7270689010620117 Unimportant Pred 0.4764351546764374 Delta Fidelity:  0.2474220097064972
Exp Len:  80 Model Pred:  0.7254630327224731 Exp Pred:  0.7263535261154175 Unimportant Pred -0.056477829813957214 Delta Fidelity:  0.781050369143486

explain 22-th: 36785 on batch 5
132
Exp Len:  10 Model Pred:  -0.012471526861190796 Exp Pred:  0.305124968290329 Unimportant Pred 0.16335415840148926 Delta Fidelity:  -0.14177080988883972
Exp Len:  20 Model Pred:  -0.012471526861190796 Exp Pred:  -0.010068506002426147 Unimportant Pred 0.23358941078186035 Delta Fidelity:  0.2436579167842865
Exp Len:  40 Model Pred:  -0.012471526861190796 Exp Pred:  -0.09723725914955139 Unimportant Pred 0.35527199506759644 Delta Fidelity:  0.28297778964042664
Exp Len:  80 Model Pred:  -0.012471526861190796 Exp Pred:  -0.008146494626998901 Unimportant Pred 0.49946358799934387 Delta Fidelity:  0.5076100826263428

explain 23-th: 36949 on batch 5
400
Exp Len:  10 Model Pred:  3.797689914703369 Exp Pred:  5.7315168380737305 Unimportant Pred 2.827136993408203 Delta Fidelity:  -0.9632740020751953
Exp Len:  20 Model Pred:  3.797689914703369 Exp Pred:  5.48265266418457 Unimportant Pred 2.848496913909912 Delta Fidelity:  -0.7357697486877441
Exp Len:  40 Model Pred:  3.797689914703369 Exp Pred:  4.884710788726807 Unimportant Pred 2.9414072036743164 Delta Fidelity:  -0.23073816299438477
Exp Len:  80 Model Pred:  3.797689914703369 Exp Pred:  4.64754581451416 Unimportant Pred 0.15548717975616455 Delta Fidelity:  2.7923468351364136

explain 24-th: 37149 on batch 5
171
Exp Len:  10 Model Pred:  1.0056124925613403 Exp Pred:  1.1091666221618652 Unimportant Pred 1.2088406085968018 Delta Fidelity:  0.09967398643493652
Exp Len:  20 Model Pred:  1.0056124925613403 Exp Pred:  1.0674681663513184 Unimportant Pred -0.036008208990097046 Delta Fidelity:  0.9797650277614594
Exp Len:  40 Model Pred:  1.0056124925613403 Exp Pred:  0.7498728036880493 Unimportant Pred -0.011540442705154419 Delta Fidelity:  0.7614132463932037
Exp Len:  80 Model Pred:  1.0056124925613403 Exp Pred:  1.0599724054336548 Unimportant Pred -0.4023965299129486 Delta Fidelity:  1.3536491096019745

explain 25-th: 37551 on batch 5
48
Exp Len:  10 Model Pred:  4.821310043334961 Exp Pred:  5.409882068634033 Unimportant Pred 4.654781341552734 Delta Fidelity:  -0.4220433235168457
Exp Len:  20 Model Pred:  4.821310043334961 Exp Pred:  4.946596145629883 Unimportant Pred 4.743930339813232 Delta Fidelity:  -0.04790639877319336
Exp Len:  40 Model Pred:  4.821310043334961 Exp Pred:  4.810129165649414 Unimportant Pred 4.313613414764404 Delta Fidelity:  0.49651575088500977
Exp Len:  47 Model Pred:  4.821310043334961 Exp Pred:  4.821310997009277 Unimportant Pred -0.8555619716644287 Delta Fidelity:  5.676871061325073

explain 26-th: 37711 on batch 5
176
Exp Len:  10 Model Pred:  -0.3482345640659332 Exp Pred:  -0.3872492015361786 Unimportant Pred -0.7790107727050781 Delta Fidelity:  0.39176157116889954
Exp Len:  20 Model Pred:  -0.3482345640659332 Exp Pred:  -0.6559443473815918 Unimportant Pred 0.01091080904006958 Delta Fidelity:  0.05143558979034424
Exp Len:  40 Model Pred:  -0.3482345640659332 Exp Pred:  -0.37585487961769104 Unimportant Pred 0.20432907342910767 Delta Fidelity:  0.5249433219432831
Exp Len:  80 Model Pred:  -0.3482345640659332 Exp Pred:  -0.4019348919391632 Unimportant Pred 0.5891327857971191 Delta Fidelity:  0.8836670219898224

explain 27-th: 37818 on batch 5
400
Exp Len:  10 Model Pred:  2.346548557281494 Exp Pred:  5.950020790100098 Unimportant Pred 1.433598518371582 Delta Fidelity:  -2.6905221939086914
Exp Len:  20 Model Pred:  2.346548557281494 Exp Pred:  -0.20233558118343353 Unimportant Pred 2.486698627471924 Delta Fidelity:  -2.408734068274498
Exp Len:  40 Model Pred:  2.346548557281494 Exp Pred:  1.6334911584854126 Unimportant Pred 2.791740894317627 Delta Fidelity:  -0.26786506175994873
Exp Len:  80 Model Pred:  2.346548557281494 Exp Pred:  3.463181495666504 Unimportant Pred 0.5031801462173462 Delta Fidelity:  0.7267354726791382

explain 28-th: 37849 on batch 5
400
Exp Len:  10 Model Pred:  -1.497475028038025 Exp Pred:  -3.599977493286133 Unimportant Pred 0.25034329295158386 Delta Fidelity:  -0.35468414425849915
Exp Len:  20 Model Pred:  -1.497475028038025 Exp Pred:  -4.609345436096191 Unimportant Pred 0.31682124733924866 Delta Fidelity:  -1.297574132680893
Exp Len:  40 Model Pred:  -1.497475028038025 Exp Pred:  -3.4753634929656982 Unimportant Pred 0.3713061213493347 Delta Fidelity:  -0.10910731554031372
Exp Len:  80 Model Pred:  -1.497475028038025 Exp Pred:  -2.7587108612060547 Unimportant Pred -0.4344313442707062 Delta Fidelity:  -0.19819214940071106
runtime: 15754.97s
