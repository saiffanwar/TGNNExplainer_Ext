PYTHONPATH=/dcs/pg21/u2188448/TGNNExplainer_Ext/tgnnexplainer
#Dataset: wikipedia, #Users: 8227, #Items: 1000, #Interactions: 157474, #Timestamps: 152757
#node feats shape: (9228, 172), #edge feats shape: (157475, 172)
443 events to explain
[2025-01-24 23:51:24,629][src.models.ext.tgat.module][INFO] - Aggregation uses attention model
[2025-01-24 23:51:24,641][src.models.ext.tgat.module][INFO] - Using scaled prod attention
[2025-01-24 23:51:24,652][src.models.ext.tgat.module][INFO] - Using scaled prod attention
[2025-01-24 23:51:24,652][src.models.ext.tgat.module][INFO] - Using time encoding
USING EXPLAINER: tgnnexplainer
USING MODEL: tgat
Initializing TGNNExplainer
90 120
Running results batch 3 with 30 events

explain 0-th: 25374 on batch 3
24
Exp Len:  10 Model Pred:  0.6322445869445801 Exp Pred:  0.536495566368103 Unimportant Pred 0.729503870010376 Delta Fidelity:  0.0015102624893188477
Exp Len:  20 Model Pred:  0.6322445869445801 Exp Pred:  0.6580954790115356 Unimportant Pred -0.3334071934223175 Delta Fidelity:  0.939800888299942
Exp Len:  23 Model Pred:  0.6322445869445801 Exp Pred:  0.6309289932250977 Unimportant Pred -0.5275681018829346 Delta Fidelity:  1.1584970951080322
Exp Len:  23 Model Pred:  0.6322445869445801 Exp Pred:  0.6309289932250977 Unimportant Pred -0.5275681018829346 Delta Fidelity:  1.1584970951080322

explain 1-th: 25406 on batch 3
33
Exp Len:  10 Model Pred:  4.030343055725098 Exp Pred:  4.529155731201172 Unimportant Pred 3.7701354026794434 Delta Fidelity:  -0.23860502243041992
Exp Len:  20 Model Pred:  4.030343055725098 Exp Pred:  3.841996192932129 Unimportant Pred 4.044704437255859 Delta Fidelity:  -0.17398548126220703
Exp Len:  32 Model Pred:  4.030343055725098 Exp Pred:  4.033795356750488 Unimportant Pred 0.6172035932540894 Delta Fidelity:  3.4096871614456177
Exp Len:  32 Model Pred:  4.030343055725098 Exp Pred:  4.033795356750488 Unimportant Pred 0.6172035932540894 Delta Fidelity:  3.4096871614456177

explain 2-th: 25454 on batch 3
17
Exp Len:  10 Model Pred:  5.460000038146973 Exp Pred:  5.61124849319458 Unimportant Pred 0.7318593263626099 Delta Fidelity:  4.576892256736755
Exp Len:  16 Model Pred:  5.460000038146973 Exp Pred:  5.476321220397949 Unimportant Pred -0.35873302817344666 Delta Fidelity:  5.802411884069443
Exp Len:  16 Model Pred:  5.460000038146973 Exp Pred:  5.476321220397949 Unimportant Pred -0.35873302817344666 Delta Fidelity:  5.802411884069443
Exp Len:  16 Model Pred:  5.460000038146973 Exp Pred:  5.476321220397949 Unimportant Pred -0.35873302817344666 Delta Fidelity:  5.802411884069443

explain 3-th: 25455 on batch 3
86
Exp Len:  10 Model Pred:  4.621399402618408 Exp Pred:  4.5136566162109375 Unimportant Pred 3.2425832748413086 Delta Fidelity:  1.271073341369629
Exp Len:  20 Model Pred:  4.621399402618408 Exp Pred:  4.285740852355957 Unimportant Pred 3.1024699211120605 Delta Fidelity:  1.1832709312438965
Exp Len:  40 Model Pred:  4.621399402618408 Exp Pred:  5.014410018920898 Unimportant Pred -1.4273021221160889 Delta Fidelity:  5.655690908432007
Exp Len:  80 Model Pred:  4.621399402618408 Exp Pred:  4.622176647186279 Unimportant Pred 0.6482318639755249 Delta Fidelity:  3.972390294075012

explain 4-th: 25554 on batch 3
400
Exp Len:  10 Model Pred:  2.327934980392456 Exp Pred:  4.427901268005371 Unimportant Pred 2.1190435886383057 Delta Fidelity:  -1.8910748958587646
Exp Len:  20 Model Pred:  2.327934980392456 Exp Pred:  4.057690620422363 Unimportant Pred 2.1571226119995117 Delta Fidelity:  -1.558943271636963
Exp Len:  40 Model Pred:  2.327934980392456 Exp Pred:  4.123814105987549 Unimportant Pred 2.3426809310913086 Delta Fidelity:  -1.7811331748962402
Exp Len:  80 Model Pred:  2.327934980392456 Exp Pred:  3.779498338699341 Unimportant Pred -0.06248706579208374 Delta Fidelity:  0.938858687877655

explain 5-th: 25760 on batch 3
249
Exp Len:  10 Model Pred:  0.8268964290618896 Exp Pred:  -0.7964671850204468 Unimportant Pred 0.8557416200637817 Delta Fidelity:  -1.5945184230804443
Exp Len:  20 Model Pred:  0.8268964290618896 Exp Pred:  0.1060234010219574 Unimportant Pred 0.8748456239700317 Delta Fidelity:  -0.6729238331317902
Exp Len:  40 Model Pred:  0.8268964290618896 Exp Pred:  0.17168155312538147 Unimportant Pred 0.9366602897644043 Delta Fidelity:  -0.5454510152339935
Exp Len:  80 Model Pred:  0.8268964290618896 Exp Pred:  1.8851540088653564 Unimportant Pred 0.1340174376964569 Delta Fidelity:  -0.36537858843803406

explain 6-th: 25858 on batch 3
400
Exp Len:  10 Model Pred:  1.5735266208648682 Exp Pred:  1.9152469635009766 Unimportant Pred 0.5989364385604858 Delta Fidelity:  0.6328698396682739
Exp Len:  20 Model Pred:  1.5735266208648682 Exp Pred:  2.5653164386749268 Unimportant Pred 0.7171307802200317 Delta Fidelity:  -0.13539397716522217
Exp Len:  40 Model Pred:  1.5735266208648682 Exp Pred:  3.235844612121582 Unimportant Pred 0.8112958669662476 Delta Fidelity:  -0.9000872373580933
Exp Len:  80 Model Pred:  1.5735266208648682 Exp Pred:  2.274359703063965 Unimportant Pred 0.8129243850708008 Delta Fidelity:  0.0597691535949707

explain 7-th: 25887 on batch 3
400
Exp Len:  10 Model Pred:  1.860175371170044 Exp Pred:  1.7237372398376465 Unimportant Pred 2.8765616416931152 Delta Fidelity:  0.8799481391906738
Exp Len:  20 Model Pred:  1.860175371170044 Exp Pred:  2.5182266235351562 Unimportant Pred 2.865673780441284 Delta Fidelity:  0.34744715690612793
Exp Len:  40 Model Pred:  1.860175371170044 Exp Pred:  3.330054759979248 Unimportant Pred 0.7995990514755249 Delta Fidelity:  -0.40930306911468506
Exp Len:  80 Model Pred:  1.860175371170044 Exp Pred:  2.99184250831604 Unimportant Pred 0.7888262271881104 Delta Fidelity:  -0.0603179931640625

explain 8-th: 26139 on batch 3
125
Exp Len:  10 Model Pred:  2.470945119857788 Exp Pred:  4.371265411376953 Unimportant Pred 0.4210101366043091 Delta Fidelity:  0.14961469173431396
Exp Len:  20 Model Pred:  2.470945119857788 Exp Pred:  4.033803462982178 Unimportant Pred 0.4475477635860443 Delta Fidelity:  0.4605390131473541
Exp Len:  40 Model Pred:  2.470945119857788 Exp Pred:  3.3135855197906494 Unimportant Pred 0.648007869720459 Delta Fidelity:  0.9802968502044678
Exp Len:  80 Model Pred:  2.470945119857788 Exp Pred:  2.7598443031311035 Unimportant Pred 1.2176703214645386 Delta Fidelity:  0.9643756151199341

explain 9-th: 26202 on batch 3
131
Exp Len:  10 Model Pred:  0.12905320525169373 Exp Pred:  0.23596221208572388 Unimportant Pred 0.20853999257087708 Delta Fidelity:  -0.027422219514846802
Exp Len:  20 Model Pred:  0.12905320525169373 Exp Pred:  0.11896511912345886 Unimportant Pred 0.23399534821510315 Delta Fidelity:  0.09485405683517456
Exp Len:  40 Model Pred:  0.12905320525169373 Exp Pred:  0.11807993054389954 Unimportant Pred 0.33500346541404724 Delta Fidelity:  0.19497698545455933
Exp Len:  80 Model Pred:  0.12905320525169373 Exp Pred:  0.12690436840057373 Unimportant Pred -0.016265705227851868 Delta Fidelity:  0.1431700736284256

explain 10-th: 26312 on batch 3
121
Exp Len:  10 Model Pred:  3.71987247467041 Exp Pred:  5.295406341552734 Unimportant Pred 2.5875790119171143 Delta Fidelity:  -0.4432404041290283
Exp Len:  20 Model Pred:  3.71987247467041 Exp Pred:  5.19888162612915 Unimportant Pred 2.618971824645996 Delta Fidelity:  -0.37810850143432617
Exp Len:  40 Model Pred:  3.71987247467041 Exp Pred:  4.82179069519043 Unimportant Pred 2.8105411529541016 Delta Fidelity:  -0.19258689880371094
Exp Len:  80 Model Pred:  3.71987247467041 Exp Pred:  4.297162055969238 Unimportant Pred -0.17360812425613403 Delta Fidelity:  3.316191017627716

explain 11-th: 26379 on batch 3
17
Exp Len:  10 Model Pred:  3.4754228591918945 Exp Pred:  3.6855039596557617 Unimportant Pred 3.7640891075134277 Delta Fidelity:  0.07858514785766602
Exp Len:  16 Model Pred:  3.4754228591918945 Exp Pred:  3.4714059829711914 Unimportant Pred 0.12241990864276886 Delta Fidelity:  3.3489860743284225
Exp Len:  16 Model Pred:  3.4754228591918945 Exp Pred:  3.4714059829711914 Unimportant Pred 0.12241990864276886 Delta Fidelity:  3.3489860743284225
Exp Len:  16 Model Pred:  3.4754228591918945 Exp Pred:  3.4714059829711914 Unimportant Pred 0.12241990864276886 Delta Fidelity:  3.3489860743284225

explain 12-th: 26442 on batch 3
400
Exp Len:  10 Model Pred:  4.770153999328613 Exp Pred:  4.210639476776123 Unimportant Pred 4.780686378479004 Delta Fidelity:  -0.5489821434020996
Exp Len:  20 Model Pred:  4.770153999328613 Exp Pred:  4.234501838684082 Unimportant Pred 4.789024353027344 Delta Fidelity:  -0.5167818069458008
Exp Len:  40 Model Pred:  4.770153999328613 Exp Pred:  4.738306999206543 Unimportant Pred 4.731708526611328 Delta Fidelity:  0.006598472595214844
Exp Len:  80 Model Pred:  4.770153999328613 Exp Pred:  5.000434398651123 Unimportant Pred 3.015517234802246 Delta Fidelity:  1.5243563652038574

explain 13-th: 26526 on batch 3
138
Exp Len:  10 Model Pred:  4.164218902587891 Exp Pred:  5.3189849853515625 Unimportant Pred 0.5013699531555176 Delta Fidelity:  2.508082866668701
Exp Len:  20 Model Pred:  4.164218902587891 Exp Pred:  4.955979347229004 Unimportant Pred 0.6882600784301758 Delta Fidelity:  2.6841983795166016
Exp Len:  40 Model Pred:  4.164218902587891 Exp Pred:  4.359432220458984 Unimportant Pred 2.2345447540283203 Delta Fidelity:  1.7344608306884766
Exp Len:  80 Model Pred:  4.164218902587891 Exp Pred:  4.160943984985352 Unimportant Pred 0.5613501071929932 Delta Fidelity:  3.5995938777923584

explain 14-th: 26889 on batch 3
400
Exp Len:  10 Model Pred:  2.818967819213867 Exp Pred:  1.9427447319030762 Unimportant Pred 2.0288336277008057 Delta Fidelity:  -0.08608889579772949
Exp Len:  20 Model Pred:  2.818967819213867 Exp Pred:  1.9899280071258545 Unimportant Pred 1.9950358867645264 Delta Fidelity:  -0.005107879638671875
Exp Len:  40 Model Pred:  2.818967819213867 Exp Pred:  2.0203816890716553 Unimportant Pred 2.1618704795837402 Delta Fidelity:  -0.14148879051208496
Exp Len:  80 Model Pred:  2.818967819213867 Exp Pred:  3.5537822246551514 Unimportant Pred 0.20668798685073853 Delta Fidelity:  1.8774654269218445

explain 15-th: 27304 on batch 3
171
Exp Len:  10 Model Pred:  3.4494404792785645 Exp Pred:  5.500869274139404 Unimportant Pred 0.26620209217071533 Delta Fidelity:  1.1318095922470093
Exp Len:  20 Model Pred:  3.4494404792785645 Exp Pred:  5.201374053955078 Unimportant Pred 0.3091403543949127 Delta Fidelity:  1.388366550207138
Exp Len:  40 Model Pred:  3.4494404792785645 Exp Pred:  4.964346408843994 Unimportant Pred 0.4537060558795929 Delta Fidelity:  1.4808284938335419
Exp Len:  80 Model Pred:  3.4494404792785645 Exp Pred:  3.9746475219726562 Unimportant Pred 0.6172010898590088 Delta Fidelity:  2.307032346725464

explain 16-th: 28197 on batch 3
86
Exp Len:  10 Model Pred:  -0.6211094856262207 Exp Pred:  -0.7637382745742798 Unimportant Pred -0.09299692511558533 Delta Fidelity:  0.3854837715625763
Exp Len:  20 Model Pred:  -0.6211094856262207 Exp Pred:  -0.5219161510467529 Unimportant Pred -0.08120085299015045 Delta Fidelity:  0.4407152980566025
Exp Len:  40 Model Pred:  -0.6211094856262207 Exp Pred:  -0.6225078105926514 Unimportant Pred 0.08013606071472168 Delta Fidelity:  0.6998472213745117
Exp Len:  80 Model Pred:  -0.6211094856262207 Exp Pred:  -0.621124267578125 Unimportant Pred -1.0765511989593506 Delta Fidelity:  0.4554269313812256

explain 17-th: 28488 on batch 3
59
Exp Len:  10 Model Pred:  2.7344303131103516 Exp Pred:  3.450406074523926 Unimportant Pred 2.620354652404785 Delta Fidelity:  -0.6019001007080078
Exp Len:  20 Model Pred:  2.7344303131103516 Exp Pred:  3.0259881019592285 Unimportant Pred 2.929450035095215 Delta Fidelity:  -0.09653806686401367
Exp Len:  40 Model Pred:  2.7344303131103516 Exp Pred:  2.87924861907959 Unimportant Pred 3.0457239151000977 Delta Fidelity:  0.1664752960205078
Exp Len:  58 Model Pred:  2.7344303131103516 Exp Pred:  2.7345454692840576 Unimportant Pred -0.8873064517974854 Delta Fidelity:  3.621621608734131

explain 18-th: 29020 on batch 3
41
Exp Len:  10 Model Pred:  5.190413951873779 Exp Pred:  5.005729675292969 Unimportant Pred 5.41417121887207 Delta Fidelity:  0.03907299041748047
Exp Len:  20 Model Pred:  5.190413951873779 Exp Pred:  5.189872741699219 Unimportant Pred -0.721589207649231 Delta Fidelity:  5.91146194934845
Exp Len:  40 Model Pred:  5.190413951873779 Exp Pred:  5.190410614013672 Unimportant Pred -0.721589207649231 Delta Fidelity:  5.911999821662903
Exp Len:  40 Model Pred:  5.190413951873779 Exp Pred:  5.190410614013672 Unimportant Pred -0.721589207649231 Delta Fidelity:  5.911999821662903

explain 19-th: 29049 on batch 3
129
Exp Len:  10 Model Pred:  2.67509126663208 Exp Pred:  3.228072166442871 Unimportant Pred 2.4203572273254395 Delta Fidelity:  -0.2982468605041504
Exp Len:  20 Model Pred:  2.67509126663208 Exp Pred:  2.7733988761901855 Unimportant Pred 2.5342469215393066 Delta Fidelity:  0.04253673553466797
Exp Len:  40 Model Pred:  2.67509126663208 Exp Pred:  2.2052812576293945 Unimportant Pred 2.798604965209961 Delta Fidelity:  -0.3462963104248047
Exp Len:  80 Model Pred:  2.67509126663208 Exp Pred:  2.851323127746582 Unimportant Pred 0.9219776391983032 Delta Fidelity:  1.576881766319275

explain 20-th: 29138 on batch 3
130
Exp Len:  10 Model Pred:  4.270175933837891 Exp Pred:  5.521109104156494 Unimportant Pred 2.6345162391662598 Delta Fidelity:  0.38472652435302734
Exp Len:  20 Model Pred:  4.270175933837891 Exp Pred:  5.216353416442871 Unimportant Pred 3.8049960136413574 Delta Fidelity:  -0.48099756240844727
Exp Len:  40 Model Pred:  4.270175933837891 Exp Pred:  4.3568243980407715 Unimportant Pred 4.420760154724121 Delta Fidelity:  0.06393575668334961
Exp Len:  80 Model Pred:  4.270175933837891 Exp Pred:  4.270096778869629 Unimportant Pred -1.776902437210083 Delta Fidelity:  6.046999216079712

explain 21-th: 29350 on batch 3
161
Exp Len:  10 Model Pred:  4.906517028808594 Exp Pred:  5.1554365158081055 Unimportant Pred 0.20484134554862976 Delta Fidelity:  4.452756196260452
Exp Len:  20 Model Pred:  4.906517028808594 Exp Pred:  4.989970684051514 Unimportant Pred 0.445055216550827 Delta Fidelity:  4.378008157014847
Exp Len:  40 Model Pred:  4.906517028808594 Exp Pred:  4.9050140380859375 Unimportant Pred -0.6095752716064453 Delta Fidelity:  5.514589309692383
Exp Len:  80 Model Pred:  4.906517028808594 Exp Pred:  4.905400276184082 Unimportant Pred -0.6095752716064453 Delta Fidelity:  5.514975547790527

explain 22-th: 29455 on batch 3
33
Exp Len:  10 Model Pred:  5.231285095214844 Exp Pred:  5.433745384216309 Unimportant Pred 5.234670639038086 Delta Fidelity:  -0.19907474517822266
Exp Len:  20 Model Pred:  5.231285095214844 Exp Pred:  5.344135761260986 Unimportant Pred 4.899694442749023 Delta Fidelity:  0.21873998641967773
Exp Len:  32 Model Pred:  5.231285095214844 Exp Pred:  5.228019714355469 Unimportant Pred 0.9325730800628662 Delta Fidelity:  4.2954466342926025
Exp Len:  32 Model Pred:  5.231285095214844 Exp Pred:  5.228019714355469 Unimportant Pred 0.9325730800628662 Delta Fidelity:  4.2954466342926025

explain 23-th: 29551 on batch 3
137
Exp Len:  10 Model Pred:  0.10718902945518494 Exp Pred:  0.21881061792373657 Unimportant Pred -0.6999770402908325 Delta Fidelity:  0.6955444812774658
Exp Len:  20 Model Pred:  0.10718902945518494 Exp Pred:  0.10551193356513977 Unimportant Pred -0.8290069103240967 Delta Fidelity:  0.9345188438892365
Exp Len:  40 Model Pred:  0.10718902945518494 Exp Pred:  0.10806140303611755 Unimportant Pred -0.8290069103240967 Delta Fidelity:  0.935323566198349
Exp Len:  80 Model Pred:  0.10718902945518494 Exp Pred:  0.10747888684272766 Unimportant Pred -0.8290069103240967 Delta Fidelity:  0.9359060823917389

explain 24-th: 29711 on batch 3
192
Exp Len:  10 Model Pred:  2.610927104949951 Exp Pred:  1.0631906986236572 Unimportant Pred 2.6566267013549805 Delta Fidelity:  -1.5020368099212646
Exp Len:  20 Model Pred:  2.610927104949951 Exp Pred:  4.167078971862793 Unimportant Pred 0.47096362709999084 Delta Fidelity:  0.5838116109371185
Exp Len:  40 Model Pred:  2.610927104949951 Exp Pred:  3.5864710807800293 Unimportant Pred 0.6191569566726685 Delta Fidelity:  1.0162261724472046
Exp Len:  80 Model Pred:  2.610927104949951 Exp Pred:  3.026681900024414 Unimportant Pred 0.6747314929962158 Delta Fidelity:  1.5204408168792725

explain 25-th: 29912 on batch 3
74
Exp Len:  10 Model Pred:  4.724731922149658 Exp Pred:  5.662133693695068 Unimportant Pred 2.9683451652526855 Delta Fidelity:  0.8189849853515625
Exp Len:  20 Model Pred:  4.724731922149658 Exp Pred:  5.3788557052612305 Unimportant Pred 3.8183586597442627 Delta Fidelity:  0.25224947929382324
Exp Len:  40 Model Pred:  4.724731922149658 Exp Pred:  4.8958516120910645 Unimportant Pred 4.42507266998291 Delta Fidelity:  0.1285395622253418
Exp Len:  73 Model Pred:  4.724731922149658 Exp Pred:  4.724776744842529 Unimportant Pred -1.3412761688232422 Delta Fidelity:  6.065963268280029

explain 26-th: 29943 on batch 3
31
Exp Len:  10 Model Pred:  2.822267770767212 Exp Pred:  2.795119524002075 Unimportant Pred 2.936880111694336 Delta Fidelity:  0.0874640941619873
Exp Len:  20 Model Pred:  2.822267770767212 Exp Pred:  2.9210290908813477 Unimportant Pred 0.28237447142601013 Delta Fidelity:  2.441131979227066
Exp Len:  30 Model Pred:  2.822267770767212 Exp Pred:  2.822205066680908 Unimportant Pred -0.6070976257324219 Delta Fidelity:  3.42930269241333
Exp Len:  30 Model Pred:  2.822267770767212 Exp Pred:  2.822205066680908 Unimportant Pred -0.6070976257324219 Delta Fidelity:  3.42930269241333

explain 27-th: 29959 on batch 3
162
Exp Len:  10 Model Pred:  -0.8363382816314697 Exp Pred:  -0.4386526644229889 Unimportant Pred -0.5541459321975708 Delta Fidelity:  -0.11549326777458191
Exp Len:  20 Model Pred:  -0.8363382816314697 Exp Pred:  0.25934898853302 Unimportant Pred -0.2814171314239502 Delta Fidelity:  -0.5407661199569702
Exp Len:  40 Model Pred:  -0.8363382816314697 Exp Pred:  -0.7248870134353638 Unimportant Pred 0.8076683282852173 Delta Fidelity:  1.532555341720581
Exp Len:  80 Model Pred:  -0.8363382816314697 Exp Pred:  -0.834917426109314 Unimportant Pred -0.508269190788269 Delta Fidelity:  0.3266482353210449

explain 28-th: 30077 on batch 3
219
Exp Len:  10 Model Pred:  0.3224043548107147 Exp Pred:  -0.5167536735534668 Unimportant Pred 0.36411234736442566 Delta Fidelity:  -0.7974500358104706
Exp Len:  20 Model Pred:  0.3224043548107147 Exp Pred:  0.3508433997631073 Unimportant Pred 0.3283420503139496 Delta Fidelity:  -0.022501349449157715
Exp Len:  40 Model Pred:  0.3224043548107147 Exp Pred:  0.3891192376613617 Unimportant Pred 0.34871068596839905 Delta Fidelity:  -0.040408551692962646
Exp Len:  80 Model Pred:  0.3224043548107147 Exp Pred:  0.3224973976612091 Unimportant Pred 0.20842048525810242 Delta Fidelity:  0.11389082670211792
runtime: 10563.46s
